name: Build and Deploy Code

on: [push, pull_request]

jobs:
  job1:
    env:
      DATABASE_HOSTNAME: localhost
      DATABASE_PORT: 5432
      DATABASE_PASSWORD: Ifeanyi058
      DATABASE_NAME: UU81
      DATABASE_USERNAME: postgres
      SECRET_KEY: 91e4626bb547fe049c7430b0d5feef13755d69b282efa970b98c146e06f7f044
      ALGORITHM: HS256
      ACCESS_TOKEN_EXPIRE_MINUTES: 30
      PAYSTACK_SECRET_KEY: 31a827d317649d69cc078065f934e4e38be4e14c2f3b33e65966dac985bdb889
      MAIL_USERNAME: zeusifeanyi058@gmail.com
      MAIL_PASSWORD: Bio_international
      MAIL_FROM: zeusifeanyi058@gmail.com
      MAIL_PORT: 587
      MAIL_SERVER: smtp.gmail.com
      MAIL_TLS: True
      MAIL_SSL: False
      USE_CREDENTIALS: True
      VALIDATE_CERTS: True

    runs-on: ubuntu-latest
    steps:
      - name: pulling git repo  
        uses: actions/checkout@v3
      - name: pip install python version 3.9
        uses: actions/setup-python@v3
        with:
          python version: "3.9"
      - name: update pip
        run: python -m pip install --upgrade pip
      - name: install all dependencies
        run: pip install -r requirements.txt
      - name: test with pytest
        run: |
          pip install pytest
          pytest 